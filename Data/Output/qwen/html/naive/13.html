<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
    font-family: Arial, sans-serif;
    line-height: 1.6;
    margin: 0;
    padding: 0;
    color: #333;
    background-color: #f4f4f4;
}
.container {
    max-width: 800px;
    margin: 50px auto;
    padding: 20px;
    background-color: #fff;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
}
header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 40px;
}
header h1 {
    font-size: 24px;
    margin: 0;
}
header nav ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
}
header nav ul li {
    display: inline;
    margin: 0 10px;
}
header nav ul li a {
    color: #333;
    text-decoration: none;
}
.post-date {
    font-size: 16px;
    color: #999;
    margin-bottom: 10px;
}
.post-date::before {
    content: "";
    display: inline-block;
    margin-right: 5px;
}
header img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
}
.post-content {
    margin: 20px 0 40px;
}
.post-title {
    font-size: 36px;
    margin: 0 0 20px;
}
.post-excerpt {
    font-size: 18px;
    color: #666;
}
.post-excerpt::before {
    content: "";
    display: inline-block;
    margin-right: 5px;
}
.post-date p {
    font-size: 14px;
    color: #999;
}
.post-excerpt p {
    margin: 0;
}
.post-excerpt p + p {
    margin-top: 15px;
}
.code-snippet {
    background-color: #f4f4f4;
    padding: 20px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}
.code-snippet p {
    margin: 0;
}
.code-snippet p + p {
    margin-top: 15px;
}
.backstory-section {
    margin: 40px 0;
}
.backstory-section h2 {
    font-size: 24px;
    margin: 0 0 10px;
}
.backstory-section p {
    font-size: 18px;
    margin: 0 0 20px;
}
.backstory-section .code snippet p {
    margin: 0;
}
.backstory-section .code snippet p + p {
    margin-top: 15px;
}
</style>
</head>
<body>
<div class="container">
<header>
<img src="src/placeholder.jpg" alt="User Profile">
<h1>Polibyte</h1>
<nav>
<ul>
<li><a href="#about-me">About Me</a></li>
</ul>
</nav>
</header>
<article class="post">
<div class="post-content">
<h1 class="post-title">Export news from google sites</h1>
<div class="post-excerpt">
<p class="post-date"><span class="post-date">Apr 27, 2012</span><span class="post-excerpt">1 minute read</span></p>
<p>I've added a script, <a class="post-excerpt" href="https://github.com/username/catchall-repo/tree/master/tools/export_google_site_news - Export Google Sites">export_google_site_news - Export Google Sites</a>, to my catchall repository on github.</p>
<p>For example, to download the news stories at https://sites.google.com/a/medinacommunityband.org/www/announcements, you would run</p>
<div class="code-snippet"><pre><span class="post-excerpt">export_google_site_news \</span>
<h2 class="backstory-section">The backstory</h2>
<p>When Free It Athens moved our website from Google Sites to Drupal, we started from scratch rather than importing our old content. I realized on Wednesday that the news posts on the site were interesting historical information, yet I’d never archived them.</p>
<p>First, I tried a recursive wget.</p>
<div class="code-snippet"><pre><span class="post-excerpt">wget -r --no-parent --no-clobber \\ </span>
<p>This failed to work because Google pointlessly used javascript rather than anchor tags to link between the news listing pages.</p>
<p>Next I found and tried to use the google-sites-export tool from Google’s Data Liberation Team, but I was never able to authenticate succesfullly from it.</p>
<p>At this point I was worried I’d need to use a tool like Selenium to run the javascript, but then I realized the news listing pages took a single paramater to determine how far along in the pagination they were. It wouldn’t take more than a C-style for loop to download them all.</p>
<div class="code-snippet"><pre><span class="post-excerpt">for i in $(seq 0 10 120); do</span>
<span class="post-excerpt">    wget "" \</span>
<span class="post-excerpt">"-Onews.$i"</span>
<span class="post-excerpt">done</span>
<p>After doing that, I looked at the first one and determined a pattern that would match the relative URLs of individual news stories. I then extracted all the URLs.</p>
<div class="code-snippet"><pre><span class="post-excerpt">grep -E -h -o '/a/freeitathens.org/foo/news/[a-z0-9\-]+' news.* |</span>
<span class="post-excerpt">sort -u &gt; news_links</span>
<p>Once I had the list of URLs, it was simple to have wget download them all.</p>
<div class="code-snippet"><pre><span class="post-excerpt">wget -i news_links -B https://sites.google.com</span>
<p>Since I didn’t find any other guides to doing this, I decided to flesh out what I’d done into a simple tool and write about it here.</p>
</body>
</html>